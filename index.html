<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signature Editor</title>
    <link rel="shortcut icon" href="https://plus.unsplash.com/premium_photo-1673326630896-73aee8b9eefc?q=80&w=1587&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.5.3/signature-pad.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="signature-container">
        <div class="buttons">
            <button id="saveButton">Download</button>
            <button id="clear-btn">Clear</button>
        </div>
        <div id="signature-pad" class="signature-pad">
            <canvas id="signatureCanvas" width="400" height="200"></canvas>
        </div>
        <div class="backgrd">
            <button id="changeBackgroundBtn">Change Background</button>
        </div>
    </div>

    <!-- External scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.5.3/signature_pad.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>

        document.addEventListener("DOMContentLoaded", function () {
            const canvas = document.querySelector('#signatureCanvas');
            const signaturePad = new SignaturePad(canvas);
            const { jsPDF } = window.jspdf;

            const saveButton = document.querySelector('#saveButton');
            saveButton.addEventListener('click', function () {
                //new canvas to include background color
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = canvas.width;
                tempCanvas.height = canvas.height;

                //background color onto the temporary canvas
                const pad = document.querySelector("#signature-pad")
                tempCtx.fillStyle = pad.style.backgroundColor;
                tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);

                //the signature image onto the temporary canvas
                tempCtx.drawImage(canvas, 0, 0);

                // the temporary canvas to data URL
                const signatureImage = tempCanvas.toDataURL();

                // PDF and add the signature image
                const doc = new jsPDF();
                doc.addImage(signatureImage, 'PNG', 10, 10, 100, 50);
                doc.save('signed_document.pdf');
            });

            document.getElementById('clear-btn').addEventListener('click', function () {
                signaturePad.clear();
            });

            // Background color change
            const backbtn = document.querySelector("#changeBackgroundBtn");

            const changeBackground = () => {
                const hex = '0123456789ABCDEF';
                let color = '#';

                for (let i = 0; i < 6; i++) {
                    color += hex[Math.floor(Math.random() * 16)];
                }
                return color;
            };

            backbtn.addEventListener("click", () => {
                const pad = document.querySelector("#signature-pad");
                pad.style.backgroundColor = changeBackground();
            });
        });


    </script>

</body>

</html>